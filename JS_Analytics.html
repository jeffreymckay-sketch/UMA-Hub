<script>
  // --- ANALYTICS & EXPLORER LOGIC ---

  // --- REPORT WIZARD ---
  function analytics_handleGenerateReport() {
    const sourceTab = document.getElementById('wizard-source-select').value;
    const filterCol = document.getElementById('wizard-filter-col').value.trim();
    const filterVal = document.getElementById('wizard-filter-val').value.trim();
    
    ui_setStatus('wizard-status', 'Generating Report...', 'loading');
    
    google.script.run.withSuccessHandler(function(res) {
      if (res.success) {
        ui_setStatus('wizard-status', 'Report Created!', 'success');
        window.open(res.url, '_blank');
      } else {
        ui_setStatus('wizard-status', res.message, 'error');
      }
    }).inspector_generatePivotReport(sourceTab, filterCol, filterVal);
  }
</script>